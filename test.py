import sys
import os
import time
from datetime import datetime
import cv2
import scipy.io as sio
import warnings
warnings.filterwarnings('ignore',category=FutureWarning)
import tensorflow as tf
import numpy as np

# PROCRUSTES
#from util.procrustes import procrustes

# Import datagenerator
from Data.datagenerator_cloth3d import *

# Import ShapeEstimator model
from Models.e2ePoseestimator import *

# Import Euclidean distance function
from Models.common import get_euc_err

# Import hourglass model
from Models.StackedHourglass.hourglassModelVoxelsBones import HourglassModel

# Import loss
from Losses.losses import VoxelLoss

'''################### set arguments ###################'''
# Args
if len(sys.argv) < 5:
    print("Missing args")
    print("1st arg: GPU (integer)")
    print("2nd arg: SHN model name for finetuning (string)")
    print("3rd arg: DA model name for finetuning (string)")
    print("4th arg: SMPLR model name for finetuning (string)")
    sys.exit()

# GPU device
os.environ["CUDA_DEVICE_ORDER"] = "PCI_BUS_ID"
os.environ["CUDA_VISIBLE_DEVICES"] = sys.argv[1]

# Finetune
finetune_shn = sys.argv[2]
finetune_dae = sys.argv[3]
finetune_smplr = sys.argv[4]

# Learning and Network parameters
num_stacks = 5
batch_size = 12
num_points = 41
num_bones = 4
voxel_depth = 16
augmentation = 0

# PATHS FOR CHECKPOINTS AND RESULTS
root = os.path.dirname(os.path.abspath(__file__))
checkpoint_path = os.path.join(root, "tmp", "checkpoints")
results_path = os.path.join(root, "tmp", "results", finetune_smplr)
if not os.path.isdir(results_path):
    print("CREATING RESULTS PATH...")
    os.makedirs(results_path)

# Path to the textfiles for the validation set
val_file = os.path.join(root, 'Data', 'val.txt')

'''################### Build data reader ###################'''
# DATA
with tf.device('/cpu:0'):
    print("Loading validation data...")
    val_data = ImageDataGenerator(val_file,
                                mode='inference',
                                batch_size=batch_size,
                                root=root+'/Data/frames',
                                shuffle=False,
                                validate=True,
                                GT_crop=True)

iterator = tf.data.Iterator.from_structure(val_data.data.output_types, val_data.data.output_shapes)
next_batch = iterator.get_next()
val_init_op = iterator.make_initializer(val_data.data)

# Number of batches
val_batches = int(np.floor(val_data.data_size / batch_size))

'''################### build stack hourglass network ###################'''
# TF placeholders
print("Creating placeholders...")
x = tf.placeholder(tf.float32, [batch_size, 256, 256, 3]) # Input image
y = tf.placeholder(tf.float32, [batch_size, num_points, 3]) # 3D Points
is_training = tf.placeholder(tf.bool)

# Initialize model
print("Initializing models...")
model = HourglassModel(x, outDim=num_points, outBones=num_bones, nbStacks=num_stacks, voxelDepth=voxel_depth, training=is_training)

# Apply soft argmax on the last SHN stack 
final = model.out[num_stacks - 1] # Nx64x64x16x(41 + 4)
voxelLoss = VoxelLoss(depth=voxel_depth)

# Joints 3D coords extraction
voxels = []
for i in range(num_points):
    heatmap = final[:, :, :, :, i]
    heatmap = tf.reshape(heatmap, (batch_size, -1, 1))
    
    heatmap = tf.nn.softmax(heatmap, axis=1)
    xxyyzz = tf.reduce_sum(tf.multiply(heatmap, voxelLoss._xxyyzz), axis=1)

    voxels.append(xxyyzz)
voxels = tf.cast(tf.stack(voxels, axis=1), tf.float32) # N x num_points x 3
shn_p3d = voxelLoss._voxels_to_points(voxels) # N x num_points x 3

'''################### build DAE and SMPLR network ###################'''
kintree = np.transpose(np.array(sio.loadmat('SMPL/kintree.mat')['kintree'], np.int32)) - 1
model = SMPLREstimator(tf.contrib.layers.flatten(shn_p3d), keep_prob=1.0, is_training=is_training, type='all', kintree=kintree, bone_template=bone_template)
joints_x = tf.reshape(model.joints_x, (-1, num_points, 3))
shape_x = model.shape_x
pose_x = model.pose_x
smpl_joints = model.J
smpl_mesh = model.T

# Compute error
smplr_x = tf.concat([smpl_joints[:, 1:, :], tf.gather(smpl_mesh, landmarks, axis=1)], axis=1)
err_shn = tf.reduce_mean(tf.sqrt(tf.reduce_sum(tf.square(tf.subtract(shn_p3d, y)), axis=2)), axis=0)*1000
err_smplr = tf.reduce_mean(tf.sqrt(tf.reduce_sum(tf.square(tf.subtract(smplr_x, y)), axis=2)), axis=0)*1000
    
# Loader
print("Listing trainable variables...")
shn_global_var_names = [u'stacked_hourglass/preprocessing/256to128/weights:0', u'BatchNorm/beta:0', u'BatchNorm/moving_mean:0', u'BatchNorm/moving_variance:0', u'weights:0', u'BatchNorm_1/beta:0', u'BatchNorm_1/moving_mean:0', u'BatchNorm_1/moving_variance:0', u'weights_1:0', u'BatchNorm_2/beta:0', u'BatchNorm_2/moving_mean:0', u'BatchNorm_2/moving_variance:0', u'weights_2:0', u'stacked_hourglass/preprocessing/residual/skipLayer/skipLayer-conv/weights:0', u'BatchNorm_3/beta:0', u'BatchNorm_3/moving_mean:0', u'BatchNorm_3/moving_variance:0', u'weights_3:0', u'BatchNorm_4/beta:0', u'BatchNorm_4/moving_mean:0', u'BatchNorm_4/moving_variance:0', u'weights_4:0', u'BatchNorm_5/beta:0', u'BatchNorm_5/moving_mean:0', u'BatchNorm_5/moving_variance:0', u'weights_5:0', u'BatchNorm_6/beta:0', u'BatchNorm_6/moving_mean:0', u'BatchNorm_6/moving_variance:0', u'weights_6:0', u'BatchNorm_7/beta:0', u'BatchNorm_7/moving_mean:0', u'BatchNorm_7/moving_variance:0', u'weights_7:0', u'BatchNorm_8/beta:0', u'BatchNorm_8/moving_mean:0', u'BatchNorm_8/moving_variance:0', u'weights_8:0', u'stacked_hourglass/preprocessing/residual_2/skipLayer/skipLayer-conv/weights:0', u'BatchNorm_9/beta:0', u'BatchNorm_9/moving_mean:0', u'BatchNorm_9/moving_variance:0', u'weights_9:0', u'BatchNorm_10/beta:0', u'BatchNorm_10/moving_mean:0', u'BatchNorm_10/moving_variance:0', u'weights_10:0', u'BatchNorm_11/beta:0', u'BatchNorm_11/moving_mean:0', u'BatchNorm_11/moving_variance:0', u'weights_11:0', u'BatchNorm_12/beta:0', u'BatchNorm_12/moving_mean:0', u'BatchNorm_12/moving_variance:0', u'weights_12:0', u'BatchNorm_13/beta:0', u'BatchNorm_13/moving_mean:0', u'BatchNorm_13/moving_variance:0', u'weights_13:0', u'BatchNorm_14/beta:0', u'BatchNorm_14/moving_mean:0', u'BatchNorm_14/moving_variance:0', u'weights_14:0', u'BatchNorm_15/beta:0', u'BatchNorm_15/moving_mean:0', u'BatchNorm_15/moving_variance:0', u'weights_15:0', u'BatchNorm_16/beta:0', u'BatchNorm_16/moving_mean:0', u'BatchNorm_16/moving_variance:0', u'weights_16:0', u'BatchNorm_17/beta:0', u'BatchNorm_17/moving_mean:0', u'BatchNorm_17/moving_variance:0', u'weights_17:0', u'BatchNorm_18/beta:0', u'BatchNorm_18/moving_mean:0', u'BatchNorm_18/moving_variance:0', u'weights_18:0', u'BatchNorm_19/beta:0', u'BatchNorm_19/moving_mean:0', u'BatchNorm_19/moving_variance:0', u'weights_19:0', u'BatchNorm_20/beta:0', u'BatchNorm_20/moving_mean:0', u'BatchNorm_20/moving_variance:0', u'weights_20:0', u'BatchNorm_21/beta:0', u'BatchNorm_21/moving_mean:0', u'BatchNorm_21/moving_variance:0', u'weights_21:0', u'BatchNorm_22/beta:0', u'BatchNorm_22/moving_mean:0', u'BatchNorm_22/moving_variance:0', u'weights_22:0', u'BatchNorm_23/beta:0', u'BatchNorm_23/moving_mean:0', u'BatchNorm_23/moving_variance:0', u'weights_23:0', u'BatchNorm_24/beta:0', u'BatchNorm_24/moving_mean:0', u'BatchNorm_24/moving_variance:0', u'weights_24:0', u'BatchNorm_25/beta:0', u'BatchNorm_25/moving_mean:0', u'BatchNorm_25/moving_variance:0', u'weights_25:0', u'BatchNorm_26/beta:0', u'BatchNorm_26/moving_mean:0', u'BatchNorm_26/moving_variance:0', u'weights_26:0', u'BatchNorm_27/beta:0', u'BatchNorm_27/moving_mean:0', u'BatchNorm_27/moving_variance:0', u'weights_27:0', u'BatchNorm_28/beta:0', u'BatchNorm_28/moving_mean:0', u'BatchNorm_28/moving_variance:0', u'weights_28:0', u'BatchNorm_29/beta:0', u'BatchNorm_29/moving_mean:0', u'BatchNorm_29/moving_variance:0', u'weights_29:0', u'BatchNorm_30/beta:0', u'BatchNorm_30/moving_mean:0', u'BatchNorm_30/moving_variance:0', u'weights_30:0', u'BatchNorm_31/beta:0', u'BatchNorm_31/moving_mean:0', u'BatchNorm_31/moving_variance:0', u'weights_31:0', u'BatchNorm_32/beta:0', u'BatchNorm_32/moving_mean:0', u'BatchNorm_32/moving_variance:0', u'weights_32:0', u'BatchNorm_33/beta:0', u'BatchNorm_33/moving_mean:0', u'BatchNorm_33/moving_variance:0', u'weights_33:0', u'BatchNorm_34/beta:0', u'BatchNorm_34/moving_mean:0', u'BatchNorm_34/moving_variance:0', u'weights_34:0', u'BatchNorm_35/beta:0', u'BatchNorm_35/moving_mean:0', u'BatchNorm_35/moving_variance:0', u'weights_35:0', u'BatchNorm_36/beta:0', u'BatchNorm_36/moving_mean:0', u'BatchNorm_36/moving_variance:0', u'weights_36:0', u'BatchNorm_37/beta:0', u'BatchNorm_37/moving_mean:0', u'BatchNorm_37/moving_variance:0', u'weights_37:0', u'BatchNorm_38/beta:0', u'BatchNorm_38/moving_mean:0', u'BatchNorm_38/moving_variance:0', u'weights_38:0', u'BatchNorm_39/beta:0', u'BatchNorm_39/moving_mean:0', u'BatchNorm_39/moving_variance:0', u'weights_39:0', u'BatchNorm_40/beta:0', u'BatchNorm_40/moving_mean:0', u'BatchNorm_40/moving_variance:0', u'weights_40:0', u'BatchNorm_41/beta:0', u'BatchNorm_41/moving_mean:0', u'BatchNorm_41/moving_variance:0', u'weights_41:0', u'BatchNorm_42/beta:0', u'BatchNorm_42/moving_mean:0', u'BatchNorm_42/moving_variance:0', u'weights_42:0', u'BatchNorm_43/beta:0', u'BatchNorm_43/moving_mean:0', u'BatchNorm_43/moving_variance:0', u'weights_43:0', u'BatchNorm_44/beta:0', u'BatchNorm_44/moving_mean:0', u'BatchNorm_44/moving_variance:0', u'weights_44:0', u'BatchNorm_45/beta:0', u'BatchNorm_45/moving_mean:0', u'BatchNorm_45/moving_variance:0', u'weights_45:0', u'BatchNorm_46/beta:0', u'BatchNorm_46/moving_mean:0', u'BatchNorm_46/moving_variance:0', u'weights_46:0', u'BatchNorm_47/beta:0', u'BatchNorm_47/moving_mean:0', u'BatchNorm_47/moving_variance:0', u'weights_47:0', u'stacked_hourglass/stacks/hourglass.1/conv_1/weights:0', u'BatchNorm_48/beta:0', u'BatchNorm_48/moving_mean:0', u'BatchNorm_48/moving_variance:0', u'stacked_hourglass/stacks/hourglass.1/ll/weights:0', u'stacked_hourglass/stacks/hourglass.1/out/weights:0', u'stacked_hourglass/stacks/hourglass.1/out_/weights:0', u'BatchNorm_49/beta:0', u'BatchNorm_49/moving_mean:0', u'BatchNorm_49/moving_variance:0', u'weights_48:0', u'BatchNorm_50/beta:0', u'BatchNorm_50/moving_mean:0', u'BatchNorm_50/moving_variance:0', u'weights_49:0', u'BatchNorm_51/beta:0', u'BatchNorm_51/moving_mean:0', u'BatchNorm_51/moving_variance:0', u'weights_50:0', u'BatchNorm_52/beta:0', u'BatchNorm_52/moving_mean:0', u'BatchNorm_52/moving_variance:0', u'weights_51:0', u'BatchNorm_53/beta:0', u'BatchNorm_53/moving_mean:0', u'BatchNorm_53/moving_variance:0', u'weights_52:0', u'BatchNorm_54/beta:0', u'BatchNorm_54/moving_mean:0', u'BatchNorm_54/moving_variance:0', u'weights_53:0', u'BatchNorm_55/beta:0', u'BatchNorm_55/moving_mean:0', u'BatchNorm_55/moving_variance:0', u'weights_54:0', u'BatchNorm_56/beta:0', u'BatchNorm_56/moving_mean:0', u'BatchNorm_56/moving_variance:0', u'weights_55:0', u'BatchNorm_57/beta:0', u'BatchNorm_57/moving_mean:0', u'BatchNorm_57/moving_variance:0', u'weights_56:0', u'BatchNorm_58/beta:0', u'BatchNorm_58/moving_mean:0', u'BatchNorm_58/moving_variance:0', u'weights_57:0', u'BatchNorm_59/beta:0', u'BatchNorm_59/moving_mean:0', u'BatchNorm_59/moving_variance:0', u'weights_58:0', u'BatchNorm_60/beta:0', u'BatchNorm_60/moving_mean:0', u'BatchNorm_60/moving_variance:0', u'weights_59:0', u'BatchNorm_61/beta:0', u'BatchNorm_61/moving_mean:0', u'BatchNorm_61/moving_variance:0', u'weights_60:0', u'BatchNorm_62/beta:0', u'BatchNorm_62/moving_mean:0', u'BatchNorm_62/moving_variance:0', u'weights_61:0', u'BatchNorm_63/beta:0', u'BatchNorm_63/moving_mean:0', u'BatchNorm_63/moving_variance:0', u'weights_62:0', u'BatchNorm_64/beta:0', u'BatchNorm_64/moving_mean:0', u'BatchNorm_64/moving_variance:0', u'weights_63:0', u'BatchNorm_65/beta:0', u'BatchNorm_65/moving_mean:0', u'BatchNorm_65/moving_variance:0', u'weights_64:0', u'BatchNorm_66/beta:0', u'BatchNorm_66/moving_mean:0', u'BatchNorm_66/moving_variance:0', u'weights_65:0', u'BatchNorm_67/beta:0', u'BatchNorm_67/moving_mean:0', u'BatchNorm_67/moving_variance:0', u'weights_66:0', u'BatchNorm_68/beta:0', u'BatchNorm_68/moving_mean:0', u'BatchNorm_68/moving_variance:0', u'weights_67:0', u'BatchNorm_69/beta:0', u'BatchNorm_69/moving_mean:0', u'BatchNorm_69/moving_variance:0', u'weights_68:0', u'BatchNorm_70/beta:0', u'BatchNorm_70/moving_mean:0', u'BatchNorm_70/moving_variance:0', u'weights_69:0', u'BatchNorm_71/beta:0', u'BatchNorm_71/moving_mean:0', u'BatchNorm_71/moving_variance:0', u'weights_70:0', u'BatchNorm_72/beta:0', u'BatchNorm_72/moving_mean:0', u'BatchNorm_72/moving_variance:0', u'weights_71:0', u'BatchNorm_73/beta:0', u'BatchNorm_73/moving_mean:0', u'BatchNorm_73/moving_variance:0', u'weights_72:0', u'BatchNorm_74/beta:0', u'BatchNorm_74/moving_mean:0', u'BatchNorm_74/moving_variance:0', u'weights_73:0', u'BatchNorm_75/beta:0', u'BatchNorm_75/moving_mean:0', u'BatchNorm_75/moving_variance:0', u'weights_74:0', u'BatchNorm_76/beta:0', u'BatchNorm_76/moving_mean:0', u'BatchNorm_76/moving_variance:0', u'weights_75:0', u'BatchNorm_77/beta:0', u'BatchNorm_77/moving_mean:0', u'BatchNorm_77/moving_variance:0', u'weights_76:0', u'BatchNorm_78/beta:0', u'BatchNorm_78/moving_mean:0', u'BatchNorm_78/moving_variance:0', u'weights_77:0', u'BatchNorm_79/beta:0', u'BatchNorm_79/moving_mean:0', u'BatchNorm_79/moving_variance:0', u'weights_78:0', u'BatchNorm_80/beta:0', u'BatchNorm_80/moving_mean:0', u'BatchNorm_80/moving_variance:0', u'weights_79:0', u'BatchNorm_81/beta:0', u'BatchNorm_81/moving_mean:0', u'BatchNorm_81/moving_variance:0', u'weights_80:0', u'BatchNorm_82/beta:0', u'BatchNorm_82/moving_mean:0', u'BatchNorm_82/moving_variance:0', u'weights_81:0', u'BatchNorm_83/beta:0', u'BatchNorm_83/moving_mean:0', u'BatchNorm_83/moving_variance:0', u'weights_82:0', u'BatchNorm_84/beta:0', u'BatchNorm_84/moving_mean:0', u'BatchNorm_84/moving_variance:0', u'weights_83:0', u'BatchNorm_85/beta:0', u'BatchNorm_85/moving_mean:0', u'BatchNorm_85/moving_variance:0', u'weights_84:0', u'BatchNorm_86/beta:0', u'BatchNorm_86/moving_mean:0', u'BatchNorm_86/moving_variance:0', u'weights_85:0', u'BatchNorm_87/beta:0', u'BatchNorm_87/moving_mean:0', u'BatchNorm_87/moving_variance:0', u'weights_86:0', u'stacked_hourglass/stacks/hourglass.2/conv_1/weights:0', u'BatchNorm_88/beta:0', u'BatchNorm_88/moving_mean:0', u'BatchNorm_88/moving_variance:0', u'stacked_hourglass/stacks/hourglass.2/ll/weights:0', u'stacked_hourglass/stacks/hourglass.2/out/weights:0', u'stacked_hourglass/stacks/hourglass.2/out_/weights:0', u'BatchNorm_89/beta:0', u'BatchNorm_89/moving_mean:0', u'BatchNorm_89/moving_variance:0', u'weights_87:0', u'BatchNorm_90/beta:0', u'BatchNorm_90/moving_mean:0', u'BatchNorm_90/moving_variance:0', u'weights_88:0', u'BatchNorm_91/beta:0', u'BatchNorm_91/moving_mean:0', u'BatchNorm_91/moving_variance:0', u'weights_89:0', u'BatchNorm_92/beta:0', u'BatchNorm_92/moving_mean:0', u'BatchNorm_92/moving_variance:0', u'weights_90:0', u'BatchNorm_93/beta:0', u'BatchNorm_93/moving_mean:0', u'BatchNorm_93/moving_variance:0', u'weights_91:0', u'BatchNorm_94/beta:0', u'BatchNorm_94/moving_mean:0', u'BatchNorm_94/moving_variance:0', u'weights_92:0', u'BatchNorm_95/beta:0', u'BatchNorm_95/moving_mean:0', u'BatchNorm_95/moving_variance:0', u'weights_93:0', u'BatchNorm_96/beta:0', u'BatchNorm_96/moving_mean:0', u'BatchNorm_96/moving_variance:0', u'weights_94:0', u'BatchNorm_97/beta:0', u'BatchNorm_97/moving_mean:0', u'BatchNorm_97/moving_variance:0', u'weights_95:0', u'BatchNorm_98/beta:0', u'BatchNorm_98/moving_mean:0', u'BatchNorm_98/moving_variance:0', u'weights_96:0', u'BatchNorm_99/beta:0', u'BatchNorm_99/moving_mean:0', u'BatchNorm_99/moving_variance:0', u'weights_97:0', u'BatchNorm_100/beta:0', u'BatchNorm_100/moving_mean:0', u'BatchNorm_100/moving_variance:0', u'weights_98:0', u'BatchNorm_101/beta:0', u'BatchNorm_101/moving_mean:0', u'BatchNorm_101/moving_variance:0', u'weights_99:0', u'BatchNorm_102/beta:0', u'BatchNorm_102/moving_mean:0', u'BatchNorm_102/moving_variance:0', u'weights_100:0', u'BatchNorm_103/beta:0', u'BatchNorm_103/moving_mean:0', u'BatchNorm_103/moving_variance:0', u'weights_101:0', u'BatchNorm_104/beta:0', u'BatchNorm_104/moving_mean:0', u'BatchNorm_104/moving_variance:0', u'weights_102:0', u'BatchNorm_105/beta:0', u'BatchNorm_105/moving_mean:0', u'BatchNorm_105/moving_variance:0', u'weights_103:0', u'BatchNorm_106/beta:0', u'BatchNorm_106/moving_mean:0', u'BatchNorm_106/moving_variance:0', u'weights_104:0', u'BatchNorm_107/beta:0', u'BatchNorm_107/moving_mean:0', u'BatchNorm_107/moving_variance:0', u'weights_105:0', u'BatchNorm_108/beta:0', u'BatchNorm_108/moving_mean:0', u'BatchNorm_108/moving_variance:0', u'weights_106:0', u'BatchNorm_109/beta:0', u'BatchNorm_109/moving_mean:0', u'BatchNorm_109/moving_variance:0', u'weights_107:0', u'BatchNorm_110/beta:0', u'BatchNorm_110/moving_mean:0', u'BatchNorm_110/moving_variance:0', u'weights_108:0', u'BatchNorm_111/beta:0', u'BatchNorm_111/moving_mean:0', u'BatchNorm_111/moving_variance:0', u'weights_109:0', u'BatchNorm_112/beta:0', u'BatchNorm_112/moving_mean:0', u'BatchNorm_112/moving_variance:0', u'weights_110:0', u'BatchNorm_113/beta:0', u'BatchNorm_113/moving_mean:0', u'BatchNorm_113/moving_variance:0', u'weights_111:0', u'BatchNorm_114/beta:0', u'BatchNorm_114/moving_mean:0', u'BatchNorm_114/moving_variance:0', u'weights_112:0', u'BatchNorm_115/beta:0', u'BatchNorm_115/moving_mean:0', u'BatchNorm_115/moving_variance:0', u'weights_113:0', u'BatchNorm_116/beta:0', u'BatchNorm_116/moving_mean:0', u'BatchNorm_116/moving_variance:0', u'weights_114:0', u'BatchNorm_117/beta:0', u'BatchNorm_117/moving_mean:0', u'BatchNorm_117/moving_variance:0', u'weights_115:0', u'BatchNorm_118/beta:0', u'BatchNorm_118/moving_mean:0', u'BatchNorm_118/moving_variance:0', u'weights_116:0', u'BatchNorm_119/beta:0', u'BatchNorm_119/moving_mean:0', u'BatchNorm_119/moving_variance:0', u'weights_117:0', u'BatchNorm_120/beta:0', u'BatchNorm_120/moving_mean:0', u'BatchNorm_120/moving_variance:0', u'weights_118:0', u'BatchNorm_121/beta:0', u'BatchNorm_121/moving_mean:0', u'BatchNorm_121/moving_variance:0', u'weights_119:0', u'BatchNorm_122/beta:0', u'BatchNorm_122/moving_mean:0', u'BatchNorm_122/moving_variance:0', u'weights_120:0', u'BatchNorm_123/beta:0', u'BatchNorm_123/moving_mean:0', u'BatchNorm_123/moving_variance:0', u'weights_121:0', u'BatchNorm_124/beta:0', u'BatchNorm_124/moving_mean:0', u'BatchNorm_124/moving_variance:0', u'weights_122:0', u'BatchNorm_125/beta:0', u'BatchNorm_125/moving_mean:0', u'BatchNorm_125/moving_variance:0', u'weights_123:0', u'BatchNorm_126/beta:0', u'BatchNorm_126/moving_mean:0', u'BatchNorm_126/moving_variance:0', u'weights_124:0', u'BatchNorm_127/beta:0', u'BatchNorm_127/moving_mean:0', u'BatchNorm_127/moving_variance:0', u'weights_125:0', u'stacked_hourglass/stacks/hourglass.3/conv_1/weights:0', u'BatchNorm_128/beta:0', u'BatchNorm_128/moving_mean:0', u'BatchNorm_128/moving_variance:0', u'stacked_hourglass/stacks/hourglass.3/ll/weights:0', u'stacked_hourglass/stacks/hourglass.3/out/weights:0', u'stacked_hourglass/stacks/hourglass.3/out_/weights:0', u'BatchNorm_129/beta:0', u'BatchNorm_129/moving_mean:0', u'BatchNorm_129/moving_variance:0', u'weights_126:0', u'BatchNorm_130/beta:0', u'BatchNorm_130/moving_mean:0', u'BatchNorm_130/moving_variance:0', u'weights_127:0', u'BatchNorm_131/beta:0', u'BatchNorm_131/moving_mean:0', u'BatchNorm_131/moving_variance:0', u'weights_128:0', u'BatchNorm_132/beta:0', u'BatchNorm_132/moving_mean:0', u'BatchNorm_132/moving_variance:0', u'weights_129:0', u'BatchNorm_133/beta:0', u'BatchNorm_133/moving_mean:0', u'BatchNorm_133/moving_variance:0', u'weights_130:0', u'BatchNorm_134/beta:0', u'BatchNorm_134/moving_mean:0', u'BatchNorm_134/moving_variance:0', u'weights_131:0', u'BatchNorm_135/beta:0', u'BatchNorm_135/moving_mean:0', u'BatchNorm_135/moving_variance:0', u'weights_132:0', u'BatchNorm_136/beta:0', u'BatchNorm_136/moving_mean:0', u'BatchNorm_136/moving_variance:0', u'weights_133:0', u'BatchNorm_137/beta:0', u'BatchNorm_137/moving_mean:0', u'BatchNorm_137/moving_variance:0', u'weights_134:0', u'BatchNorm_138/beta:0', u'BatchNorm_138/moving_mean:0', u'BatchNorm_138/moving_variance:0', u'weights_135:0', u'BatchNorm_139/beta:0', u'BatchNorm_139/moving_mean:0', u'BatchNorm_139/moving_variance:0', u'weights_136:0', u'BatchNorm_140/beta:0', u'BatchNorm_140/moving_mean:0', u'BatchNorm_140/moving_variance:0', u'weights_137:0', u'BatchNorm_141/beta:0', u'BatchNorm_141/moving_mean:0', u'BatchNorm_141/moving_variance:0', u'weights_138:0', u'BatchNorm_142/beta:0', u'BatchNorm_142/moving_mean:0', u'BatchNorm_142/moving_variance:0', u'weights_139:0', u'BatchNorm_143/beta:0', u'BatchNorm_143/moving_mean:0', u'BatchNorm_143/moving_variance:0', u'weights_140:0', u'BatchNorm_144/beta:0', u'BatchNorm_144/moving_mean:0', u'BatchNorm_144/moving_variance:0', u'weights_141:0', u'BatchNorm_145/beta:0', u'BatchNorm_145/moving_mean:0', u'BatchNorm_145/moving_variance:0', u'weights_142:0', u'BatchNorm_146/beta:0', u'BatchNorm_146/moving_mean:0', u'BatchNorm_146/moving_variance:0', u'weights_143:0', u'BatchNorm_147/beta:0', u'BatchNorm_147/moving_mean:0', u'BatchNorm_147/moving_variance:0', u'weights_144:0', u'BatchNorm_148/beta:0', u'BatchNorm_148/moving_mean:0', u'BatchNorm_148/moving_variance:0', u'weights_145:0', u'BatchNorm_149/beta:0', u'BatchNorm_149/moving_mean:0', u'BatchNorm_149/moving_variance:0', u'weights_146:0', u'BatchNorm_150/beta:0', u'BatchNorm_150/moving_mean:0', u'BatchNorm_150/moving_variance:0', u'weights_147:0', u'BatchNorm_151/beta:0', u'BatchNorm_151/moving_mean:0', u'BatchNorm_151/moving_variance:0', u'weights_148:0', u'BatchNorm_152/beta:0', u'BatchNorm_152/moving_mean:0', u'BatchNorm_152/moving_variance:0', u'weights_149:0', u'BatchNorm_153/beta:0', u'BatchNorm_153/moving_mean:0', u'BatchNorm_153/moving_variance:0', u'weights_150:0', u'BatchNorm_154/beta:0', u'BatchNorm_154/moving_mean:0', u'BatchNorm_154/moving_variance:0', u'weights_151:0', u'BatchNorm_155/beta:0', u'BatchNorm_155/moving_mean:0', u'BatchNorm_155/moving_variance:0', u'weights_152:0', u'BatchNorm_156/beta:0', u'BatchNorm_156/moving_mean:0', u'BatchNorm_156/moving_variance:0', u'weights_153:0', u'BatchNorm_157/beta:0', u'BatchNorm_157/moving_mean:0', u'BatchNorm_157/moving_variance:0', u'weights_154:0', u'BatchNorm_158/beta:0', u'BatchNorm_158/moving_mean:0', u'BatchNorm_158/moving_variance:0', u'weights_155:0', u'BatchNorm_159/beta:0', u'BatchNorm_159/moving_mean:0', u'BatchNorm_159/moving_variance:0', u'weights_156:0', u'BatchNorm_160/beta:0', u'BatchNorm_160/moving_mean:0', u'BatchNorm_160/moving_variance:0', u'weights_157:0', u'BatchNorm_161/beta:0', u'BatchNorm_161/moving_mean:0', u'BatchNorm_161/moving_variance:0', u'weights_158:0', u'BatchNorm_162/beta:0', u'BatchNorm_162/moving_mean:0', u'BatchNorm_162/moving_variance:0', u'weights_159:0', u'BatchNorm_163/beta:0', u'BatchNorm_163/moving_mean:0', u'BatchNorm_163/moving_variance:0', u'weights_160:0', u'BatchNorm_164/beta:0', u'BatchNorm_164/moving_mean:0', u'BatchNorm_164/moving_variance:0', u'weights_161:0', u'BatchNorm_165/beta:0', u'BatchNorm_165/moving_mean:0', u'BatchNorm_165/moving_variance:0', u'weights_162:0', u'BatchNorm_166/beta:0', u'BatchNorm_166/moving_mean:0', u'BatchNorm_166/moving_variance:0', u'weights_163:0', u'BatchNorm_167/beta:0', u'BatchNorm_167/moving_mean:0', u'BatchNorm_167/moving_variance:0', u'weights_164:0', u'stacked_hourglass/stacks/hourglass.4/conv_1/weights:0', u'BatchNorm_168/beta:0', u'BatchNorm_168/moving_mean:0', u'BatchNorm_168/moving_variance:0', u'stacked_hourglass/stacks/hourglass.4/ll/weights:0', u'stacked_hourglass/stacks/hourglass.4/out/weights:0', u'stacked_hourglass/stacks/hourglass.4/out_/weights:0', u'BatchNorm_169/beta:0', u'BatchNorm_169/moving_mean:0', u'BatchNorm_169/moving_variance:0', u'weights_165:0', u'BatchNorm_170/beta:0', u'BatchNorm_170/moving_mean:0', u'BatchNorm_170/moving_variance:0', u'weights_166:0', u'BatchNorm_171/beta:0', u'BatchNorm_171/moving_mean:0', u'BatchNorm_171/moving_variance:0', u'weights_167:0', u'BatchNorm_172/beta:0', u'BatchNorm_172/moving_mean:0', u'BatchNorm_172/moving_variance:0', u'weights_168:0', u'BatchNorm_173/beta:0', u'BatchNorm_173/moving_mean:0', u'BatchNorm_173/moving_variance:0', u'weights_169:0', u'BatchNorm_174/beta:0', u'BatchNorm_174/moving_mean:0', u'BatchNorm_174/moving_variance:0', u'weights_170:0', u'BatchNorm_175/beta:0', u'BatchNorm_175/moving_mean:0', u'BatchNorm_175/moving_variance:0', u'weights_171:0', u'BatchNorm_176/beta:0', u'BatchNorm_176/moving_mean:0', u'BatchNorm_176/moving_variance:0', u'weights_172:0', u'BatchNorm_177/beta:0', u'BatchNorm_177/moving_mean:0', u'BatchNorm_177/moving_variance:0', u'weights_173:0', u'BatchNorm_178/beta:0', u'BatchNorm_178/moving_mean:0', u'BatchNorm_178/moving_variance:0', u'weights_174:0', u'BatchNorm_179/beta:0', u'BatchNorm_179/moving_mean:0', u'BatchNorm_179/moving_variance:0', u'weights_175:0', u'BatchNorm_180/beta:0', u'BatchNorm_180/moving_mean:0', u'BatchNorm_180/moving_variance:0', u'weights_176:0', u'BatchNorm_181/beta:0', u'BatchNorm_181/moving_mean:0', u'BatchNorm_181/moving_variance:0', u'weights_177:0', u'BatchNorm_182/beta:0', u'BatchNorm_182/moving_mean:0', u'BatchNorm_182/moving_variance:0', u'weights_178:0', u'BatchNorm_183/beta:0', u'BatchNorm_183/moving_mean:0', u'BatchNorm_183/moving_variance:0', u'weights_179:0', u'BatchNorm_184/beta:0', u'BatchNorm_184/moving_mean:0', u'BatchNorm_184/moving_variance:0', u'weights_180:0', u'BatchNorm_185/beta:0', u'BatchNorm_185/moving_mean:0', u'BatchNorm_185/moving_variance:0', u'weights_181:0', u'BatchNorm_186/beta:0', u'BatchNorm_186/moving_mean:0', u'BatchNorm_186/moving_variance:0', u'weights_182:0', u'BatchNorm_187/beta:0', u'BatchNorm_187/moving_mean:0', u'BatchNorm_187/moving_variance:0', u'weights_183:0', u'BatchNorm_188/beta:0', u'BatchNorm_188/moving_mean:0', u'BatchNorm_188/moving_variance:0', u'weights_184:0', u'BatchNorm_189/beta:0', u'BatchNorm_189/moving_mean:0', u'BatchNorm_189/moving_variance:0', u'weights_185:0', u'BatchNorm_190/beta:0', u'BatchNorm_190/moving_mean:0', u'BatchNorm_190/moving_variance:0', u'weights_186:0', u'BatchNorm_191/beta:0', u'BatchNorm_191/moving_mean:0', u'BatchNorm_191/moving_variance:0', u'weights_187:0', u'BatchNorm_192/beta:0', u'BatchNorm_192/moving_mean:0', u'BatchNorm_192/moving_variance:0', u'weights_188:0', u'BatchNorm_193/beta:0', u'BatchNorm_193/moving_mean:0', u'BatchNorm_193/moving_variance:0', u'weights_189:0', u'BatchNorm_194/beta:0', u'BatchNorm_194/moving_mean:0', u'BatchNorm_194/moving_variance:0', u'weights_190:0', u'BatchNorm_195/beta:0', u'BatchNorm_195/moving_mean:0', u'BatchNorm_195/moving_variance:0', u'weights_191:0', u'BatchNorm_196/beta:0', u'BatchNorm_196/moving_mean:0', u'BatchNorm_196/moving_variance:0', u'weights_192:0', u'BatchNorm_197/beta:0', u'BatchNorm_197/moving_mean:0', u'BatchNorm_197/moving_variance:0', u'weights_193:0', u'BatchNorm_198/beta:0', u'BatchNorm_198/moving_mean:0', u'BatchNorm_198/moving_variance:0', u'weights_194:0', u'BatchNorm_199/beta:0', u'BatchNorm_199/moving_mean:0', u'BatchNorm_199/moving_variance:0', u'weights_195:0', u'BatchNorm_200/beta:0', u'BatchNorm_200/moving_mean:0', u'BatchNorm_200/moving_variance:0', u'weights_196:0', u'BatchNorm_201/beta:0', u'BatchNorm_201/moving_mean:0', u'BatchNorm_201/moving_variance:0', u'weights_197:0', u'BatchNorm_202/beta:0', u'BatchNorm_202/moving_mean:0', u'BatchNorm_202/moving_variance:0', u'weights_198:0', u'BatchNorm_203/beta:0', u'BatchNorm_203/moving_mean:0', u'BatchNorm_203/moving_variance:0', u'weights_199:0', u'BatchNorm_204/beta:0', u'BatchNorm_204/moving_mean:0', u'BatchNorm_204/moving_variance:0', u'weights_200:0', u'BatchNorm_205/beta:0', u'BatchNorm_205/moving_mean:0', u'BatchNorm_205/moving_variance:0', u'weights_201:0', u'BatchNorm_206/beta:0', u'BatchNorm_206/moving_mean:0', u'BatchNorm_206/moving_variance:0', u'weights_202:0', u'BatchNorm_207/beta:0', u'BatchNorm_207/moving_mean:0', u'BatchNorm_207/moving_variance:0', u'weights_203:0', u'stacked_hourglass/stacks/hourglass.5/conv_1/weights:0', u'BatchNorm_208/beta:0', u'BatchNorm_208/moving_mean:0', u'BatchNorm_208/moving_variance:0', u'stacked_hourglass/stacks/hourglass.5/out/weights:0', u'train/beta1_power:0', u'train/beta2_power:0', u'stacked_hourglass/preprocessing/256to128/weights/Adam:0', u'stacked_hourglass/preprocessing/256to128/weights/Adam_1:0', u'BatchNorm/beta/Adam:0', u'BatchNorm/beta/Adam_1:0', u'weights/Adam:0', u'weights/Adam_1:0', u'BatchNorm_1/beta/Adam:0', u'BatchNorm_1/beta/Adam_1:0', u'weights_1/Adam:0', u'weights_1/Adam_1:0', u'BatchNorm_2/beta/Adam:0', u'BatchNorm_2/beta/Adam_1:0', u'weights_2/Adam:0', u'weights_2/Adam_1:0', u'stacked_hourglass/preprocessing/residual/skipLayer/skipLayer-conv/weights/Adam:0', u'stacked_hourglass/preprocessing/residual/skipLayer/skipLayer-conv/weights/Adam_1:0', u'BatchNorm_3/beta/Adam:0', u'BatchNorm_3/beta/Adam_1:0', u'weights_3/Adam:0', u'weights_3/Adam_1:0', u'BatchNorm_4/beta/Adam:0', u'BatchNorm_4/beta/Adam_1:0', u'weights_4/Adam:0', u'weights_4/Adam_1:0', u'BatchNorm_5/beta/Adam:0', u'BatchNorm_5/beta/Adam_1:0', u'weights_5/Adam:0', u'weights_5/Adam_1:0', u'BatchNorm_6/beta/Adam:0', u'BatchNorm_6/beta/Adam_1:0', u'weights_6/Adam:0', u'weights_6/Adam_1:0', u'BatchNorm_7/beta/Adam:0', u'BatchNorm_7/beta/Adam_1:0', u'weights_7/Adam:0', u'weights_7/Adam_1:0', u'BatchNorm_8/beta/Adam:0', u'BatchNorm_8/beta/Adam_1:0', u'weights_8/Adam:0', u'weights_8/Adam_1:0', u'stacked_hourglass/preprocessing/residual_2/skipLayer/skipLayer-conv/weights/Adam:0', u'stacked_hourglass/preprocessing/residual_2/skipLayer/skipLayer-conv/weights/Adam_1:0', u'BatchNorm_9/beta/Adam:0', u'BatchNorm_9/beta/Adam_1:0', u'weights_9/Adam:0', u'weights_9/Adam_1:0', u'BatchNorm_10/beta/Adam:0', u'BatchNorm_10/beta/Adam_1:0', u'weights_10/Adam:0', u'weights_10/Adam_1:0', u'BatchNorm_11/beta/Adam:0', u'BatchNorm_11/beta/Adam_1:0', u'weights_11/Adam:0', u'weights_11/Adam_1:0', u'BatchNorm_12/beta/Adam:0', u'BatchNorm_12/beta/Adam_1:0', u'weights_12/Adam:0', u'weights_12/Adam_1:0', u'BatchNorm_13/beta/Adam:0', u'BatchNorm_13/beta/Adam_1:0', u'weights_13/Adam:0', u'weights_13/Adam_1:0', u'BatchNorm_14/beta/Adam:0', u'BatchNorm_14/beta/Adam_1:0', u'weights_14/Adam:0', u'weights_14/Adam_1:0', u'BatchNorm_15/beta/Adam:0', u'BatchNorm_15/beta/Adam_1:0', u'weights_15/Adam:0', u'weights_15/Adam_1:0', u'BatchNorm_16/beta/Adam:0', u'BatchNorm_16/beta/Adam_1:0', u'weights_16/Adam:0', u'weights_16/Adam_1:0', u'BatchNorm_17/beta/Adam:0', u'BatchNorm_17/beta/Adam_1:0', u'weights_17/Adam:0', u'weights_17/Adam_1:0', u'BatchNorm_18/beta/Adam:0', u'BatchNorm_18/beta/Adam_1:0', u'weights_18/Adam:0', u'weights_18/Adam_1:0', u'BatchNorm_19/beta/Adam:0', u'BatchNorm_19/beta/Adam_1:0', u'weights_19/Adam:0', u'weights_19/Adam_1:0', u'BatchNorm_20/beta/Adam:0', u'BatchNorm_20/beta/Adam_1:0', u'weights_20/Adam:0', u'weights_20/Adam_1:0', u'BatchNorm_21/beta/Adam:0', u'BatchNorm_21/beta/Adam_1:0', u'weights_21/Adam:0', u'weights_21/Adam_1:0', u'BatchNorm_22/beta/Adam:0', u'BatchNorm_22/beta/Adam_1:0', u'weights_22/Adam:0', u'weights_22/Adam_1:0', u'BatchNorm_23/beta/Adam:0', u'BatchNorm_23/beta/Adam_1:0', u'weights_23/Adam:0', u'weights_23/Adam_1:0', u'BatchNorm_24/beta/Adam:0', u'BatchNorm_24/beta/Adam_1:0', u'weights_24/Adam:0', u'weights_24/Adam_1:0', u'BatchNorm_25/beta/Adam:0', u'BatchNorm_25/beta/Adam_1:0', u'weights_25/Adam:0', u'weights_25/Adam_1:0', u'BatchNorm_26/beta/Adam:0', u'BatchNorm_26/beta/Adam_1:0', u'weights_26/Adam:0', u'weights_26/Adam_1:0', u'BatchNorm_27/beta/Adam:0', u'BatchNorm_27/beta/Adam_1:0', u'weights_27/Adam:0', u'weights_27/Adam_1:0', u'BatchNorm_28/beta/Adam:0', u'BatchNorm_28/beta/Adam_1:0', u'weights_28/Adam:0', u'weights_28/Adam_1:0', u'BatchNorm_29/beta/Adam:0', u'BatchNorm_29/beta/Adam_1:0', u'weights_29/Adam:0', u'weights_29/Adam_1:0', u'BatchNorm_30/beta/Adam:0', u'BatchNorm_30/beta/Adam_1:0', u'weights_30/Adam:0', u'weights_30/Adam_1:0', u'BatchNorm_31/beta/Adam:0', u'BatchNorm_31/beta/Adam_1:0', u'weights_31/Adam:0', u'weights_31/Adam_1:0', u'BatchNorm_32/beta/Adam:0', u'BatchNorm_32/beta/Adam_1:0', u'weights_32/Adam:0', u'weights_32/Adam_1:0', u'BatchNorm_33/beta/Adam:0', u'BatchNorm_33/beta/Adam_1:0', u'weights_33/Adam:0', u'weights_33/Adam_1:0', u'BatchNorm_34/beta/Adam:0', u'BatchNorm_34/beta/Adam_1:0', u'weights_34/Adam:0', u'weights_34/Adam_1:0', u'BatchNorm_35/beta/Adam:0', u'BatchNorm_35/beta/Adam_1:0', u'weights_35/Adam:0', u'weights_35/Adam_1:0', u'BatchNorm_36/beta/Adam:0', u'BatchNorm_36/beta/Adam_1:0', u'weights_36/Adam:0', u'weights_36/Adam_1:0', u'BatchNorm_37/beta/Adam:0', u'BatchNorm_37/beta/Adam_1:0', u'weights_37/Adam:0', u'weights_37/Adam_1:0', u'BatchNorm_38/beta/Adam:0', u'BatchNorm_38/beta/Adam_1:0', u'weights_38/Adam:0', u'weights_38/Adam_1:0', u'BatchNorm_39/beta/Adam:0', u'BatchNorm_39/beta/Adam_1:0', u'weights_39/Adam:0', u'weights_39/Adam_1:0', u'BatchNorm_40/beta/Adam:0', u'BatchNorm_40/beta/Adam_1:0', u'weights_40/Adam:0', u'weights_40/Adam_1:0', u'BatchNorm_41/beta/Adam:0', u'BatchNorm_41/beta/Adam_1:0', u'weights_41/Adam:0', u'weights_41/Adam_1:0', u'BatchNorm_42/beta/Adam:0', u'BatchNorm_42/beta/Adam_1:0', u'weights_42/Adam:0', u'weights_42/Adam_1:0', u'BatchNorm_43/beta/Adam:0', u'BatchNorm_43/beta/Adam_1:0', u'weights_43/Adam:0', u'weights_43/Adam_1:0', u'BatchNorm_44/beta/Adam:0', u'BatchNorm_44/beta/Adam_1:0', u'weights_44/Adam:0', u'weights_44/Adam_1:0', u'BatchNorm_45/beta/Adam:0', u'BatchNorm_45/beta/Adam_1:0', u'weights_45/Adam:0', u'weights_45/Adam_1:0', u'BatchNorm_46/beta/Adam:0', u'BatchNorm_46/beta/Adam_1:0', u'weights_46/Adam:0', u'weights_46/Adam_1:0', u'BatchNorm_47/beta/Adam:0', u'BatchNorm_47/beta/Adam_1:0', u'weights_47/Adam:0', u'weights_47/Adam_1:0', u'stacked_hourglass/stacks/hourglass.1/conv_1/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.1/conv_1/weights/Adam_1:0', u'BatchNorm_48/beta/Adam:0', u'BatchNorm_48/beta/Adam_1:0', u'stacked_hourglass/stacks/hourglass.1/ll/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.1/ll/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.1/out/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.1/out/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.1/out_/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.1/out_/weights/Adam_1:0', u'BatchNorm_49/beta/Adam:0', u'BatchNorm_49/beta/Adam_1:0', u'weights_48/Adam:0', u'weights_48/Adam_1:0', u'BatchNorm_50/beta/Adam:0', u'BatchNorm_50/beta/Adam_1:0', u'weights_49/Adam:0', u'weights_49/Adam_1:0', u'BatchNorm_51/beta/Adam:0', u'BatchNorm_51/beta/Adam_1:0', u'weights_50/Adam:0', u'weights_50/Adam_1:0', u'BatchNorm_52/beta/Adam:0', u'BatchNorm_52/beta/Adam_1:0', u'weights_51/Adam:0', u'weights_51/Adam_1:0', u'BatchNorm_53/beta/Adam:0', u'BatchNorm_53/beta/Adam_1:0', u'weights_52/Adam:0', u'weights_52/Adam_1:0', u'BatchNorm_54/beta/Adam:0', u'BatchNorm_54/beta/Adam_1:0', u'weights_53/Adam:0', u'weights_53/Adam_1:0', u'BatchNorm_55/beta/Adam:0', u'BatchNorm_55/beta/Adam_1:0', u'weights_54/Adam:0', u'weights_54/Adam_1:0', u'BatchNorm_56/beta/Adam:0', u'BatchNorm_56/beta/Adam_1:0', u'weights_55/Adam:0', u'weights_55/Adam_1:0', u'BatchNorm_57/beta/Adam:0', u'BatchNorm_57/beta/Adam_1:0', u'weights_56/Adam:0', u'weights_56/Adam_1:0', u'BatchNorm_58/beta/Adam:0', u'BatchNorm_58/beta/Adam_1:0', u'weights_57/Adam:0', u'weights_57/Adam_1:0', u'BatchNorm_59/beta/Adam:0', u'BatchNorm_59/beta/Adam_1:0', u'weights_58/Adam:0', u'weights_58/Adam_1:0', u'BatchNorm_60/beta/Adam:0', u'BatchNorm_60/beta/Adam_1:0', u'weights_59/Adam:0', u'weights_59/Adam_1:0', u'BatchNorm_61/beta/Adam:0', u'BatchNorm_61/beta/Adam_1:0', u'weights_60/Adam:0', u'weights_60/Adam_1:0', u'BatchNorm_62/beta/Adam:0', u'BatchNorm_62/beta/Adam_1:0', u'weights_61/Adam:0', u'weights_61/Adam_1:0', u'BatchNorm_63/beta/Adam:0', u'BatchNorm_63/beta/Adam_1:0', u'weights_62/Adam:0', u'weights_62/Adam_1:0', u'BatchNorm_64/beta/Adam:0', u'BatchNorm_64/beta/Adam_1:0', u'weights_63/Adam:0', u'weights_63/Adam_1:0', u'BatchNorm_65/beta/Adam:0', u'BatchNorm_65/beta/Adam_1:0', u'weights_64/Adam:0', u'weights_64/Adam_1:0', u'BatchNorm_66/beta/Adam:0', u'BatchNorm_66/beta/Adam_1:0', u'weights_65/Adam:0', u'weights_65/Adam_1:0', u'BatchNorm_67/beta/Adam:0', u'BatchNorm_67/beta/Adam_1:0', u'weights_66/Adam:0', u'weights_66/Adam_1:0', u'BatchNorm_68/beta/Adam:0', u'BatchNorm_68/beta/Adam_1:0', u'weights_67/Adam:0', u'weights_67/Adam_1:0', u'BatchNorm_69/beta/Adam:0', u'BatchNorm_69/beta/Adam_1:0', u'weights_68/Adam:0', u'weights_68/Adam_1:0', u'BatchNorm_70/beta/Adam:0', u'BatchNorm_70/beta/Adam_1:0', u'weights_69/Adam:0', u'weights_69/Adam_1:0', u'BatchNorm_71/beta/Adam:0', u'BatchNorm_71/beta/Adam_1:0', u'weights_70/Adam:0', u'weights_70/Adam_1:0', u'BatchNorm_72/beta/Adam:0', u'BatchNorm_72/beta/Adam_1:0', u'weights_71/Adam:0', u'weights_71/Adam_1:0', u'BatchNorm_73/beta/Adam:0', u'BatchNorm_73/beta/Adam_1:0', u'weights_72/Adam:0', u'weights_72/Adam_1:0', u'BatchNorm_74/beta/Adam:0', u'BatchNorm_74/beta/Adam_1:0', u'weights_73/Adam:0', u'weights_73/Adam_1:0', u'BatchNorm_75/beta/Adam:0', u'BatchNorm_75/beta/Adam_1:0', u'weights_74/Adam:0', u'weights_74/Adam_1:0', u'BatchNorm_76/beta/Adam:0', u'BatchNorm_76/beta/Adam_1:0', u'weights_75/Adam:0', u'weights_75/Adam_1:0', u'BatchNorm_77/beta/Adam:0', u'BatchNorm_77/beta/Adam_1:0', u'weights_76/Adam:0', u'weights_76/Adam_1:0', u'BatchNorm_78/beta/Adam:0', u'BatchNorm_78/beta/Adam_1:0', u'weights_77/Adam:0', u'weights_77/Adam_1:0', u'BatchNorm_79/beta/Adam:0', u'BatchNorm_79/beta/Adam_1:0', u'weights_78/Adam:0', u'weights_78/Adam_1:0', u'BatchNorm_80/beta/Adam:0', u'BatchNorm_80/beta/Adam_1:0', u'weights_79/Adam:0', u'weights_79/Adam_1:0', u'BatchNorm_81/beta/Adam:0', u'BatchNorm_81/beta/Adam_1:0', u'weights_80/Adam:0', u'weights_80/Adam_1:0', u'BatchNorm_82/beta/Adam:0', u'BatchNorm_82/beta/Adam_1:0', u'weights_81/Adam:0', u'weights_81/Adam_1:0', u'BatchNorm_83/beta/Adam:0', u'BatchNorm_83/beta/Adam_1:0', u'weights_82/Adam:0', u'weights_82/Adam_1:0', u'BatchNorm_84/beta/Adam:0', u'BatchNorm_84/beta/Adam_1:0', u'weights_83/Adam:0', u'weights_83/Adam_1:0', u'BatchNorm_85/beta/Adam:0', u'BatchNorm_85/beta/Adam_1:0', u'weights_84/Adam:0', u'weights_84/Adam_1:0', u'BatchNorm_86/beta/Adam:0', u'BatchNorm_86/beta/Adam_1:0', u'weights_85/Adam:0', u'weights_85/Adam_1:0', u'BatchNorm_87/beta/Adam:0', u'BatchNorm_87/beta/Adam_1:0', u'weights_86/Adam:0', u'weights_86/Adam_1:0', u'stacked_hourglass/stacks/hourglass.2/conv_1/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.2/conv_1/weights/Adam_1:0', u'BatchNorm_88/beta/Adam:0', u'BatchNorm_88/beta/Adam_1:0', u'stacked_hourglass/stacks/hourglass.2/ll/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.2/ll/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.2/out/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.2/out/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.2/out_/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.2/out_/weights/Adam_1:0', u'BatchNorm_89/beta/Adam:0', u'BatchNorm_89/beta/Adam_1:0', u'weights_87/Adam:0', u'weights_87/Adam_1:0', u'BatchNorm_90/beta/Adam:0', u'BatchNorm_90/beta/Adam_1:0', u'weights_88/Adam:0', u'weights_88/Adam_1:0', u'BatchNorm_91/beta/Adam:0', u'BatchNorm_91/beta/Adam_1:0', u'weights_89/Adam:0', u'weights_89/Adam_1:0', u'BatchNorm_92/beta/Adam:0', u'BatchNorm_92/beta/Adam_1:0', u'weights_90/Adam:0', u'weights_90/Adam_1:0', u'BatchNorm_93/beta/Adam:0', u'BatchNorm_93/beta/Adam_1:0', u'weights_91/Adam:0', u'weights_91/Adam_1:0', u'BatchNorm_94/beta/Adam:0', u'BatchNorm_94/beta/Adam_1:0', u'weights_92/Adam:0', u'weights_92/Adam_1:0', u'BatchNorm_95/beta/Adam:0', u'BatchNorm_95/beta/Adam_1:0', u'weights_93/Adam:0', u'weights_93/Adam_1:0', u'BatchNorm_96/beta/Adam:0', u'BatchNorm_96/beta/Adam_1:0', u'weights_94/Adam:0', u'weights_94/Adam_1:0', u'BatchNorm_97/beta/Adam:0', u'BatchNorm_97/beta/Adam_1:0', u'weights_95/Adam:0', u'weights_95/Adam_1:0', u'BatchNorm_98/beta/Adam:0', u'BatchNorm_98/beta/Adam_1:0', u'weights_96/Adam:0', u'weights_96/Adam_1:0', u'BatchNorm_99/beta/Adam:0', u'BatchNorm_99/beta/Adam_1:0', u'weights_97/Adam:0', u'weights_97/Adam_1:0', u'BatchNorm_100/beta/Adam:0', u'BatchNorm_100/beta/Adam_1:0', u'weights_98/Adam:0', u'weights_98/Adam_1:0', u'BatchNorm_101/beta/Adam:0', u'BatchNorm_101/beta/Adam_1:0', u'weights_99/Adam:0', u'weights_99/Adam_1:0', u'BatchNorm_102/beta/Adam:0', u'BatchNorm_102/beta/Adam_1:0', u'weights_100/Adam:0', u'weights_100/Adam_1:0', u'BatchNorm_103/beta/Adam:0', u'BatchNorm_103/beta/Adam_1:0', u'weights_101/Adam:0', u'weights_101/Adam_1:0', u'BatchNorm_104/beta/Adam:0', u'BatchNorm_104/beta/Adam_1:0', u'weights_102/Adam:0', u'weights_102/Adam_1:0', u'BatchNorm_105/beta/Adam:0', u'BatchNorm_105/beta/Adam_1:0', u'weights_103/Adam:0', u'weights_103/Adam_1:0', u'BatchNorm_106/beta/Adam:0', u'BatchNorm_106/beta/Adam_1:0', u'weights_104/Adam:0', u'weights_104/Adam_1:0', u'BatchNorm_107/beta/Adam:0', u'BatchNorm_107/beta/Adam_1:0', u'weights_105/Adam:0', u'weights_105/Adam_1:0', u'BatchNorm_108/beta/Adam:0', u'BatchNorm_108/beta/Adam_1:0', u'weights_106/Adam:0', u'weights_106/Adam_1:0', u'BatchNorm_109/beta/Adam:0', u'BatchNorm_109/beta/Adam_1:0', u'weights_107/Adam:0', u'weights_107/Adam_1:0', u'BatchNorm_110/beta/Adam:0', u'BatchNorm_110/beta/Adam_1:0', u'weights_108/Adam:0', u'weights_108/Adam_1:0', u'BatchNorm_111/beta/Adam:0', u'BatchNorm_111/beta/Adam_1:0', u'weights_109/Adam:0', u'weights_109/Adam_1:0', u'BatchNorm_112/beta/Adam:0', u'BatchNorm_112/beta/Adam_1:0', u'weights_110/Adam:0', u'weights_110/Adam_1:0', u'BatchNorm_113/beta/Adam:0', u'BatchNorm_113/beta/Adam_1:0', u'weights_111/Adam:0', u'weights_111/Adam_1:0', u'BatchNorm_114/beta/Adam:0', u'BatchNorm_114/beta/Adam_1:0', u'weights_112/Adam:0', u'weights_112/Adam_1:0', u'BatchNorm_115/beta/Adam:0', u'BatchNorm_115/beta/Adam_1:0', u'weights_113/Adam:0', u'weights_113/Adam_1:0', u'BatchNorm_116/beta/Adam:0', u'BatchNorm_116/beta/Adam_1:0', u'weights_114/Adam:0', u'weights_114/Adam_1:0', u'BatchNorm_117/beta/Adam:0', u'BatchNorm_117/beta/Adam_1:0', u'weights_115/Adam:0', u'weights_115/Adam_1:0', u'BatchNorm_118/beta/Adam:0', u'BatchNorm_118/beta/Adam_1:0', u'weights_116/Adam:0', u'weights_116/Adam_1:0', u'BatchNorm_119/beta/Adam:0', u'BatchNorm_119/beta/Adam_1:0', u'weights_117/Adam:0', u'weights_117/Adam_1:0', u'BatchNorm_120/beta/Adam:0', u'BatchNorm_120/beta/Adam_1:0', u'weights_118/Adam:0', u'weights_118/Adam_1:0', u'BatchNorm_121/beta/Adam:0', u'BatchNorm_121/beta/Adam_1:0', u'weights_119/Adam:0', u'weights_119/Adam_1:0', u'BatchNorm_122/beta/Adam:0', u'BatchNorm_122/beta/Adam_1:0', u'weights_120/Adam:0', u'weights_120/Adam_1:0', u'BatchNorm_123/beta/Adam:0', u'BatchNorm_123/beta/Adam_1:0', u'weights_121/Adam:0', u'weights_121/Adam_1:0', u'BatchNorm_124/beta/Adam:0', u'BatchNorm_124/beta/Adam_1:0', u'weights_122/Adam:0', u'weights_122/Adam_1:0', u'BatchNorm_125/beta/Adam:0', u'BatchNorm_125/beta/Adam_1:0', u'weights_123/Adam:0', u'weights_123/Adam_1:0', u'BatchNorm_126/beta/Adam:0', u'BatchNorm_126/beta/Adam_1:0', u'weights_124/Adam:0', u'weights_124/Adam_1:0', u'BatchNorm_127/beta/Adam:0', u'BatchNorm_127/beta/Adam_1:0', u'weights_125/Adam:0', u'weights_125/Adam_1:0', u'stacked_hourglass/stacks/hourglass.3/conv_1/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.3/conv_1/weights/Adam_1:0', u'BatchNorm_128/beta/Adam:0', u'BatchNorm_128/beta/Adam_1:0', u'stacked_hourglass/stacks/hourglass.3/ll/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.3/ll/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.3/out/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.3/out/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.3/out_/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.3/out_/weights/Adam_1:0', u'BatchNorm_129/beta/Adam:0', u'BatchNorm_129/beta/Adam_1:0', u'weights_126/Adam:0', u'weights_126/Adam_1:0', u'BatchNorm_130/beta/Adam:0', u'BatchNorm_130/beta/Adam_1:0', u'weights_127/Adam:0', u'weights_127/Adam_1:0', u'BatchNorm_131/beta/Adam:0', u'BatchNorm_131/beta/Adam_1:0', u'weights_128/Adam:0', u'weights_128/Adam_1:0', u'BatchNorm_132/beta/Adam:0', u'BatchNorm_132/beta/Adam_1:0', u'weights_129/Adam:0', u'weights_129/Adam_1:0', u'BatchNorm_133/beta/Adam:0', u'BatchNorm_133/beta/Adam_1:0', u'weights_130/Adam:0', u'weights_130/Adam_1:0', u'BatchNorm_134/beta/Adam:0', u'BatchNorm_134/beta/Adam_1:0', u'weights_131/Adam:0', u'weights_131/Adam_1:0', u'BatchNorm_135/beta/Adam:0', u'BatchNorm_135/beta/Adam_1:0', u'weights_132/Adam:0', u'weights_132/Adam_1:0', u'BatchNorm_136/beta/Adam:0', u'BatchNorm_136/beta/Adam_1:0', u'weights_133/Adam:0', u'weights_133/Adam_1:0', u'BatchNorm_137/beta/Adam:0', u'BatchNorm_137/beta/Adam_1:0', u'weights_134/Adam:0', u'weights_134/Adam_1:0', u'BatchNorm_138/beta/Adam:0', u'BatchNorm_138/beta/Adam_1:0', u'weights_135/Adam:0', u'weights_135/Adam_1:0', u'BatchNorm_139/beta/Adam:0', u'BatchNorm_139/beta/Adam_1:0', u'weights_136/Adam:0', u'weights_136/Adam_1:0', u'BatchNorm_140/beta/Adam:0', u'BatchNorm_140/beta/Adam_1:0', u'weights_137/Adam:0', u'weights_137/Adam_1:0', u'BatchNorm_141/beta/Adam:0', u'BatchNorm_141/beta/Adam_1:0', u'weights_138/Adam:0', u'weights_138/Adam_1:0', u'BatchNorm_142/beta/Adam:0', u'BatchNorm_142/beta/Adam_1:0', u'weights_139/Adam:0', u'weights_139/Adam_1:0', u'BatchNorm_143/beta/Adam:0', u'BatchNorm_143/beta/Adam_1:0', u'weights_140/Adam:0', u'weights_140/Adam_1:0', u'BatchNorm_144/beta/Adam:0', u'BatchNorm_144/beta/Adam_1:0', u'weights_141/Adam:0', u'weights_141/Adam_1:0', u'BatchNorm_145/beta/Adam:0', u'BatchNorm_145/beta/Adam_1:0', u'weights_142/Adam:0', u'weights_142/Adam_1:0', u'BatchNorm_146/beta/Adam:0', u'BatchNorm_146/beta/Adam_1:0', u'weights_143/Adam:0', u'weights_143/Adam_1:0', u'BatchNorm_147/beta/Adam:0', u'BatchNorm_147/beta/Adam_1:0', u'weights_144/Adam:0', u'weights_144/Adam_1:0', u'BatchNorm_148/beta/Adam:0', u'BatchNorm_148/beta/Adam_1:0', u'weights_145/Adam:0', u'weights_145/Adam_1:0', u'BatchNorm_149/beta/Adam:0', u'BatchNorm_149/beta/Adam_1:0', u'weights_146/Adam:0', u'weights_146/Adam_1:0', u'BatchNorm_150/beta/Adam:0', u'BatchNorm_150/beta/Adam_1:0', u'weights_147/Adam:0', u'weights_147/Adam_1:0', u'BatchNorm_151/beta/Adam:0', u'BatchNorm_151/beta/Adam_1:0', u'weights_148/Adam:0', u'weights_148/Adam_1:0', u'BatchNorm_152/beta/Adam:0', u'BatchNorm_152/beta/Adam_1:0', u'weights_149/Adam:0', u'weights_149/Adam_1:0', u'BatchNorm_153/beta/Adam:0', u'BatchNorm_153/beta/Adam_1:0', u'weights_150/Adam:0', u'weights_150/Adam_1:0', u'BatchNorm_154/beta/Adam:0', u'BatchNorm_154/beta/Adam_1:0', u'weights_151/Adam:0', u'weights_151/Adam_1:0', u'BatchNorm_155/beta/Adam:0', u'BatchNorm_155/beta/Adam_1:0', u'weights_152/Adam:0', u'weights_152/Adam_1:0', u'BatchNorm_156/beta/Adam:0', u'BatchNorm_156/beta/Adam_1:0', u'weights_153/Adam:0', u'weights_153/Adam_1:0', u'BatchNorm_157/beta/Adam:0', u'BatchNorm_157/beta/Adam_1:0', u'weights_154/Adam:0', u'weights_154/Adam_1:0', u'BatchNorm_158/beta/Adam:0', u'BatchNorm_158/beta/Adam_1:0', u'weights_155/Adam:0', u'weights_155/Adam_1:0', u'BatchNorm_159/beta/Adam:0', u'BatchNorm_159/beta/Adam_1:0', u'weights_156/Adam:0', u'weights_156/Adam_1:0', u'BatchNorm_160/beta/Adam:0', u'BatchNorm_160/beta/Adam_1:0', u'weights_157/Adam:0', u'weights_157/Adam_1:0', u'BatchNorm_161/beta/Adam:0', u'BatchNorm_161/beta/Adam_1:0', u'weights_158/Adam:0', u'weights_158/Adam_1:0', u'BatchNorm_162/beta/Adam:0', u'BatchNorm_162/beta/Adam_1:0', u'weights_159/Adam:0', u'weights_159/Adam_1:0', u'BatchNorm_163/beta/Adam:0', u'BatchNorm_163/beta/Adam_1:0', u'weights_160/Adam:0', u'weights_160/Adam_1:0', u'BatchNorm_164/beta/Adam:0', u'BatchNorm_164/beta/Adam_1:0', u'weights_161/Adam:0', u'weights_161/Adam_1:0', u'BatchNorm_165/beta/Adam:0', u'BatchNorm_165/beta/Adam_1:0', u'weights_162/Adam:0', u'weights_162/Adam_1:0', u'BatchNorm_166/beta/Adam:0', u'BatchNorm_166/beta/Adam_1:0', u'weights_163/Adam:0', u'weights_163/Adam_1:0', u'BatchNorm_167/beta/Adam:0', u'BatchNorm_167/beta/Adam_1:0', u'weights_164/Adam:0', u'weights_164/Adam_1:0', u'stacked_hourglass/stacks/hourglass.4/conv_1/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.4/conv_1/weights/Adam_1:0', u'BatchNorm_168/beta/Adam:0', u'BatchNorm_168/beta/Adam_1:0', u'stacked_hourglass/stacks/hourglass.4/ll/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.4/ll/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.4/out/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.4/out/weights/Adam_1:0', u'stacked_hourglass/stacks/hourglass.4/out_/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.4/out_/weights/Adam_1:0', u'BatchNorm_169/beta/Adam:0', u'BatchNorm_169/beta/Adam_1:0', u'weights_165/Adam:0', u'weights_165/Adam_1:0', u'BatchNorm_170/beta/Adam:0', u'BatchNorm_170/beta/Adam_1:0', u'weights_166/Adam:0', u'weights_166/Adam_1:0', u'BatchNorm_171/beta/Adam:0', u'BatchNorm_171/beta/Adam_1:0', u'weights_167/Adam:0', u'weights_167/Adam_1:0', u'BatchNorm_172/beta/Adam:0', u'BatchNorm_172/beta/Adam_1:0', u'weights_168/Adam:0', u'weights_168/Adam_1:0', u'BatchNorm_173/beta/Adam:0', u'BatchNorm_173/beta/Adam_1:0', u'weights_169/Adam:0', u'weights_169/Adam_1:0', u'BatchNorm_174/beta/Adam:0', u'BatchNorm_174/beta/Adam_1:0', u'weights_170/Adam:0', u'weights_170/Adam_1:0', u'BatchNorm_175/beta/Adam:0', u'BatchNorm_175/beta/Adam_1:0', u'weights_171/Adam:0', u'weights_171/Adam_1:0', u'BatchNorm_176/beta/Adam:0', u'BatchNorm_176/beta/Adam_1:0', u'weights_172/Adam:0', u'weights_172/Adam_1:0', u'BatchNorm_177/beta/Adam:0', u'BatchNorm_177/beta/Adam_1:0', u'weights_173/Adam:0', u'weights_173/Adam_1:0', u'BatchNorm_178/beta/Adam:0', u'BatchNorm_178/beta/Adam_1:0', u'weights_174/Adam:0', u'weights_174/Adam_1:0', u'BatchNorm_179/beta/Adam:0', u'BatchNorm_179/beta/Adam_1:0', u'weights_175/Adam:0', u'weights_175/Adam_1:0', u'BatchNorm_180/beta/Adam:0', u'BatchNorm_180/beta/Adam_1:0', u'weights_176/Adam:0', u'weights_176/Adam_1:0', u'BatchNorm_181/beta/Adam:0', u'BatchNorm_181/beta/Adam_1:0', u'weights_177/Adam:0', u'weights_177/Adam_1:0', u'BatchNorm_182/beta/Adam:0', u'BatchNorm_182/beta/Adam_1:0', u'weights_178/Adam:0', u'weights_178/Adam_1:0', u'BatchNorm_183/beta/Adam:0', u'BatchNorm_183/beta/Adam_1:0', u'weights_179/Adam:0', u'weights_179/Adam_1:0', u'BatchNorm_184/beta/Adam:0', u'BatchNorm_184/beta/Adam_1:0', u'weights_180/Adam:0', u'weights_180/Adam_1:0', u'BatchNorm_185/beta/Adam:0', u'BatchNorm_185/beta/Adam_1:0', u'weights_181/Adam:0', u'weights_181/Adam_1:0', u'BatchNorm_186/beta/Adam:0', u'BatchNorm_186/beta/Adam_1:0', u'weights_182/Adam:0', u'weights_182/Adam_1:0', u'BatchNorm_187/beta/Adam:0', u'BatchNorm_187/beta/Adam_1:0', u'weights_183/Adam:0', u'weights_183/Adam_1:0', u'BatchNorm_188/beta/Adam:0', u'BatchNorm_188/beta/Adam_1:0', u'weights_184/Adam:0', u'weights_184/Adam_1:0', u'BatchNorm_189/beta/Adam:0', u'BatchNorm_189/beta/Adam_1:0', u'weights_185/Adam:0', u'weights_185/Adam_1:0', u'BatchNorm_190/beta/Adam:0', u'BatchNorm_190/beta/Adam_1:0', u'weights_186/Adam:0', u'weights_186/Adam_1:0', u'BatchNorm_191/beta/Adam:0', u'BatchNorm_191/beta/Adam_1:0', u'weights_187/Adam:0', u'weights_187/Adam_1:0', u'BatchNorm_192/beta/Adam:0', u'BatchNorm_192/beta/Adam_1:0', u'weights_188/Adam:0', u'weights_188/Adam_1:0', u'BatchNorm_193/beta/Adam:0', u'BatchNorm_193/beta/Adam_1:0', u'weights_189/Adam:0', u'weights_189/Adam_1:0', u'BatchNorm_194/beta/Adam:0', u'BatchNorm_194/beta/Adam_1:0', u'weights_190/Adam:0', u'weights_190/Adam_1:0', u'BatchNorm_195/beta/Adam:0', u'BatchNorm_195/beta/Adam_1:0', u'weights_191/Adam:0', u'weights_191/Adam_1:0', u'BatchNorm_196/beta/Adam:0', u'BatchNorm_196/beta/Adam_1:0', u'weights_192/Adam:0', u'weights_192/Adam_1:0', u'BatchNorm_197/beta/Adam:0', u'BatchNorm_197/beta/Adam_1:0', u'weights_193/Adam:0', u'weights_193/Adam_1:0', u'BatchNorm_198/beta/Adam:0', u'BatchNorm_198/beta/Adam_1:0', u'weights_194/Adam:0', u'weights_194/Adam_1:0', u'BatchNorm_199/beta/Adam:0', u'BatchNorm_199/beta/Adam_1:0', u'weights_195/Adam:0', u'weights_195/Adam_1:0', u'BatchNorm_200/beta/Adam:0', u'BatchNorm_200/beta/Adam_1:0', u'weights_196/Adam:0', u'weights_196/Adam_1:0', u'BatchNorm_201/beta/Adam:0', u'BatchNorm_201/beta/Adam_1:0', u'weights_197/Adam:0', u'weights_197/Adam_1:0', u'BatchNorm_202/beta/Adam:0', u'BatchNorm_202/beta/Adam_1:0', u'weights_198/Adam:0', u'weights_198/Adam_1:0', u'BatchNorm_203/beta/Adam:0', u'BatchNorm_203/beta/Adam_1:0', u'weights_199/Adam:0', u'weights_199/Adam_1:0', u'BatchNorm_204/beta/Adam:0', u'BatchNorm_204/beta/Adam_1:0', u'weights_200/Adam:0', u'weights_200/Adam_1:0', u'BatchNorm_205/beta/Adam:0', u'BatchNorm_205/beta/Adam_1:0', u'weights_201/Adam:0', u'weights_201/Adam_1:0', u'BatchNorm_206/beta/Adam:0', u'BatchNorm_206/beta/Adam_1:0', u'weights_202/Adam:0', u'weights_202/Adam_1:0', u'BatchNorm_207/beta/Adam:0', u'BatchNorm_207/beta/Adam_1:0', u'weights_203/Adam:0', u'weights_203/Adam_1:0', u'stacked_hourglass/stacks/hourglass.5/conv_1/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.5/conv_1/weights/Adam_1:0', u'BatchNorm_208/beta/Adam:0', u'BatchNorm_208/beta/Adam_1:0', u'stacked_hourglass/stacks/hourglass.5/out/weights/Adam:0', u'stacked_hourglass/stacks/hourglass.5/out/weights/Adam_1:0']
var_list = tf.global_variables()
shn_global_vars = []
for l in var_list:
    if l.name in shn_global_var_names:
        shn_global_vars.append(l)
shn_loader = tf.train.Saver(var_list=shn_global_vars)
dae_loader = tf.train.Saver(var_list=tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope='dae'))
shape_loader = tf.train.Saver(var_list=tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope='shape'))
pose_loader = tf.train.Saver(var_list=tf.get_collection(tf.GraphKeys.GLOBAL_VARIABLES, scope='pose'))

'''################### start session ###################'''
# Start TF session
with tf.Session() as sess:
    # Initialize variable
    sess.run(tf.global_variables_initializer())
    
    shn_loader.restore(sess, os.path.join(checkpoint_path, finetune_shn + '.ckpt'))
    dae_loader.restore(sess, os.path.join(checkpoint_path, finetune_dae + '.ckpt'))
    shape_loader.restore(sess, os.path.join(checkpoint_path, finetune_smplr + '.ckpt'))
    pose_loader.restore(sess, os.path.join(checkpoint_path, finetune_smplr + '.ckpt'))
    
    # Go over steps
    start = time.time()
    print("")
    print("")
    print("VALIDATION")
    sess.run(val_init_op)
    
    val_err_shn = np.zeros(num_points)
    val_err_smplr = np.zeros(num_points)
    val_count = 0
    for val_step in range(val_batches):
        img_batch, _, label_batch, pose_batch, shape_batch, path_batch = sess.run(next_batch)

        feed_dict = {x: img_batch,
                    y: label_batch[:, :num_points],
                    is_training: False}
                    
        opts = [shn_p3d, shape_x, pose_x, smpl_joints, smpl_mesh, err_shn, err_smplr]
        _shn_p3d, _shape_x, _pose_x, _smpl_joints, _smpl_mesh, _err_shn, _err_smplr = sess.run(opts, feed_dict=feed_dict)
        
        # sio.savemat(results_path + '/batch' + str(val_step), {'shn': _shn_p3d,
                                                                # 'label': label_batch[:, :num_points],
                                                                # 'pose': _pose_x,
                                                                # 'shape': _shape_x,
                                                                # 'smplr_joints': _smpl_joints,
                                                                # 'smplr_mesh': _smpl_mesh,
                                                                # 'path': path_batch})
        # Compute cumulative sum
        val_err_shn += _err_shn
        val_err_smplr += _err_smplr
        val_count += 1
        
        sys.stdout.write("\rStep: " + str(val_step + 1) + "/" + str(val_batches) + ' Error SHN (mm): ' + str(_err_shn.mean()) + ' Error SMPLR (mm): ' + str(_err_smplr.mean()))
        sys.stdout.flush()
    
    val_err_shn /= val_count
    val_err_smplr /= val_count
    print("")
    print("Error SHN (mm): Joints=" + str(val_err_shn[:23].mean()) + ", Landmarks=" + str(val_err_shn[23:].mean()) + ", All=" + str(val_err_shn.mean()))
    print("Error SMPLR (mm): Joints=" + str(val_err_smplr[:23].mean()) + ", Landmarks=" + str(val_err_smplr[23:].mean()) + ", All=" + str(val_err_smplr.mean()))
    val_err_2_ = np.concatenate((np.zeros([1]), val_err_smplr))
    for key in eval_joints.keys():
        if key == 'All': continue
        print("\t SMPLR " + key + ": " + str(np.mean(val_err_2_[eval_joints[key]])))
    final_error = np.mean(val_err_2_[eval_joints['All']])
    print("All: " + str(final_error))
    print("")
    
    print("")
    print("ELAPSED: {:.2f}".format(time.time() - start))
